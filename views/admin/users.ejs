<%- include('../partials/admin-header', { currentPage: 'users' }) %>

<div class="admin-page">
    <div class="container">
        <h1 class="admin-page__title">üë• Qu·∫£n L√Ω Ng∆∞·ªùi D√πng</h1>
        
        <% if (users && users.length > 0) { %>
            <div class="admin-table-wrapper">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>H·ªç T√™n</th>
                            <th>Email</th>
                            <th class="text-center">Vai Tr√≤</th>
                            <th class="text-center">Tr·∫°ng Th√°i</th>
                            <th class="text-center">Ng√†y T·∫°o</th>
                            <th class="text-center">Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% users.forEach(u => { %>
                            <tr>
                                <td><%= u.id %></td>
                                <td><strong><%= u.full_name %></strong></td>
                                <td><%= u.email %></td>
                                <td class="text-center">
                                    <span class="admin-table__badge" style="background: <%= u.role === 'admin' ? '#e3f2fd' : '#f5f5f5' %>; color: <%= u.role === 'admin' ? '#1976d2' : '#666' %>;">
                                        <%= u.role === 'admin' ? 'Admin' : 'Kh√°ch h√†ng' %>
                                    </span>
                                </td>
                                <td class="text-center">
                                    <% const isActive = Boolean(u.is_active); %>
                                    <span class="admin-table__badge" style="background: <%= isActive ? '#e8f5e9' : '#ffebee' %>; color: <%= isActive ? '#2e7d32' : '#c62828' %>;">
                                        <%= isActive ? 'Ho·∫°t ƒë·ªông' : 'B·ªã kh√≥a' %>
                                    </span>
                                </td>
                                <td class="text-center" style="color: #666;"><%= new Date(u.created_at).toLocaleDateString('vi-VN') %></td>
                                <td class="text-center">
                                    <% if (u.role !== 'admin') { %>
                                        <button onclick="toggleUserStatus('<%= u.id %>', <%= isActive %>)" class="admin-btn" style="background: <%= isActive ? '#ffebee' : '#e8f5e9' %>; color: <%= isActive ? '#c62828' : '#2e7d32' %>;">
                                            <%= isActive ? 'üîí Kh√≥a' : 'üîì M·ªü kh√≥a' %>
                                        </button>
                                    <% } else { %>
                                        <span style="color: #999; font-size: 12px;">-</span>
                                    <% } %>
                                </td>
                            </tr>
                        <% }) %>
                    </tbody>
                </table>
            </div>
        <% } else { %>
            <div class="admin-empty">
                <span class="admin-empty__icon">üë§</span>
                <h3 class="admin-empty__title">Ch∆∞a c√≥ ng∆∞·ªùi d√πng n√†o</h3>
            </div>
        <% } %>
    </div>
</div>

<!-- Toast Container -->
<div id="toastContainer"></div>

<!-- Confirm Modal -->
<div id="confirmModal">
    <div class="confirm-modal__content">
        <h3 id="confirmTitle" class="confirm-modal__title">X√°c nh·∫≠n</h3>
        <p id="confirmMessage" class="confirm-modal__message">B·∫°n c√≥ ch·∫Øc mu·ªën th·ª±c hi·ªán?</p>
        <div class="confirm-modal__buttons">
            <button id="confirmYes" class="confirm-modal__btn confirm-modal__btn--yes">Kh√≥a</button>
            <button id="confirmNo" class="confirm-modal__btn confirm-modal__btn--no">H·ªßy</button>
        </div>
    </div>
</div>

<script src="/js/admin/users.js"></script>

<%- include('../partials/admin-footer') %>
