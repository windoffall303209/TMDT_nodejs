<%- include('../partials/admin-header', { currentPage: 'orders' }) %>

<div class="admin-page">
    <div class="container">
        <h1 class="admin-page__title">üõí Qu·∫£n L√Ω ƒê∆°n H√†ng</h1>
        
        <% if (orders && orders.length > 0) { %>
            <div class="admin-table-wrapper">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>M√£ ƒê∆°n</th>
                            <th>Kh√°ch H√†ng</th>
                            <th class="text-right">T·ªïng Ti·ªÅn</th>
                            <th class="text-center">Thanh To√°n</th>
                            <th class="text-center">Tr·∫°ng Th√°i</th>
                            <th class="text-center">Ng√†y</th>
                            <th class="text-center">Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% orders.forEach(order => { %>
                            <tr>
                                <td><strong><%= order.order_code %></strong></td>
                                <td><%= order.user_name || order.recipient_name || 'N/A' %></td>
                                <td class="text-right admin-table__price">
                                    <%= (order.final_amount || order.total_amount || 0).toLocaleString('vi-VN') %>ƒë
                                </td>
                                <td class="text-center">
                                    <span class="admin-table__badge" style="background: <%= order.payment_status === 'paid' ? '#e8f5e9' : '#fff3e0' %>; color: <%= order.payment_status === 'paid' ? '#2e7d32' : '#ef6c00' %>;">
                                        <%= order.payment_status === 'paid' ? 'ƒê√£ TT' : 'Ch∆∞a TT' %>
                                    </span>
                                </td>
                                <td class="text-center">
                                    <select onchange="updateOrderStatus('<%= order.id %>', this.value)" class="admin-form__select" style="padding: 6px 12px;">
                                        <option value="pending" <%= order.status === 'pending' ? 'selected' : '' %>>Ch·ªù x·ª≠ l√Ω</option>
                                        <option value="confirmed" <%= order.status === 'confirmed' ? 'selected' : '' %>>ƒê√£ x√°c nh·∫≠n</option>
                                        <option value="shipping" <%= order.status === 'shipping' ? 'selected' : '' %>>ƒêang giao</option>
                                        <option value="delivered" <%= order.status === 'delivered' ? 'selected' : '' %>>ƒê√£ giao</option>
                                        <option value="cancelled" <%= order.status === 'cancelled' ? 'selected' : '' %>>ƒê√£ h·ªßy</option>
                                    </select>
                                </td>
                                <td class="text-center" style="color: #666;"><%= new Date(order.created_at).toLocaleDateString('vi-VN') %></td>
                                <td class="text-center">
                                    <button onclick="viewOrderDetail('<%= order.id %>')" class="admin-btn" style="background: #667eea; color: white;">Chi ti·∫øt</button>
                                </td>
                            </tr>
                        <% }) %>
                    </tbody>
                </table>
            </div>
        <% } else { %>
            <div class="admin-empty">
                <span class="admin-empty__icon">üì≠</span>
                <h3 class="admin-empty__title">Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o</h3>
            </div>
        <% } %>
    </div>
</div>

<script src="/js/admin/orders.js"></script>

<%- include('../partials/admin-footer') %>
