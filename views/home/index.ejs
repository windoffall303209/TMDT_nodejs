<%- include('../partials/header') %>

<!-- Popup Banner Ad (Random - Image Only) -->
<% if (banners && banners.length > 0) { %>
    <% const randomBanner = banners[Math.floor(Math.random() * banners.length)]; %>
    <% if (randomBanner.image_url) { %>
        <div id="popupBanner" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; display: flex; align-items: center; justify-content: center;">
            <div style="position: relative; max-width: 700px; width: 95%;">
                <!-- Close Button -->
                <button onclick="closePopup()" style="position: absolute; top: -15px; right: -15px; width: 40px; height: 40px; border-radius: 50%; border: none; background: white; color: #333; font-size: 24px; cursor: pointer; z-index: 10; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 10px rgba(0,0,0,0.3);">√ó</button>
                
                <% if (randomBanner.link_url) { %>
                    <a href="<%= randomBanner.link_url %>">
                        <img src="<%= randomBanner.image_url %>" alt="Qu·∫£ng c√°o" style="width: 100%; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.4);">
                    </a>
                <% } else { %>
                    <img src="<%= randomBanner.image_url %>" alt="Qu·∫£ng c√°o" style="width: 100%; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.4);">
                <% } %>
            </div>
        </div>
        <script>
            function closePopup() {
                document.getElementById('popupBanner').style.display = 'none';
                sessionStorage.setItem('bannerClosed', 'true');
            }
            if (sessionStorage.getItem('bannerClosed')) {
                document.getElementById('popupBanner').style.display = 'none';
            }
        </script>
    <% } %>
<% } %>

<!-- Hero Intro Section -->
<div class="hero" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); padding: 100px 0; color: white; text-align: center; position: relative; overflow: hidden;">
    <div class="container" style="position: relative; z-index: 1;">
        <h1 style="font-size: 56px; margin-bottom: 20px; font-weight: 700; letter-spacing: 3px;">
            üçÇ WIND OF FALL
        </h1>
        <p style="font-size: 20px; margin-bottom: 15px; opacity: 0.9; max-width: 600px; margin-left: auto; margin-right: auto;">
            Th·ªùi trang cao c·∫•p d√†nh cho nh·ªØng ai y√™u phong c√°ch
        </p>
        <p style="font-size: 16px; margin-bottom: 40px; opacity: 0.7;">
            Kh√°m ph√° b·ªô s∆∞u t·∫≠p m·ªõi nh·∫•t t·ª´ c√°c th∆∞∆°ng hi·ªáu h√†ng ƒë·∫ßu
        </p>
        <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
            <a href="/products" class="btn" style="background: white; color: #1a1a2e; padding: 15px 40px; font-size: 16px; font-weight: 600; border-radius: 30px; text-decoration: none; transition: all 0.3s;">üõçÔ∏è Mua S·∫Øm Ngay</a>
            <a href="/products/category/nu" class="btn" style="background: transparent; color: white; padding: 15px 40px; font-size: 16px; font-weight: 600; border-radius: 30px; text-decoration: none; border: 2px solid white; transition: all 0.3s;">üíÉ B·ªô S∆∞u T·∫≠p N·ªØ</a>
        </div>
    </div>
</div>

<!-- Categories Section -->
<section class="products-section" style="padding: 60px 0;">
    <div class="container">
        <h2 class="section-title" style="text-align: center; font-size: 32px; margin-bottom: 40px;">Danh M·ª•c S·∫£n Ph·∫©m</h2>
        
        <% if (categories && categories.length > 0) { %>
            <div class="category-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px;">
                <% categories.forEach(category => { %>
                    <a href="/products/category/<%= category.slug %>" style="text-decoration: none;">
                        <div class="category-card" style="position: relative; height: 250px; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: transform 0.3s;">
                            <% if (category.image_url) { %>
                                <img src="<%= category.image_url %>" alt="<%= category.name %>" style="width: 100%; height: 100%; object-fit: cover;">
                            <% } else { %>
                                <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                            <% } %>
                            <div style="position: absolute; bottom: 0; left: 0; right: 0; padding: 20px; background: linear-gradient(transparent, rgba(0,0,0,0.8)); color: white;">
                                <h3 style="margin: 0 0 5px 0; font-size: 24px;"><%= category.name %></h3>
                                <p style="margin: 0; opacity: 0.8;"><%= category.product_count || 0 %> s·∫£n ph·∫©m</p>
                            </div>
                        </div>
                    </a>
                <% }) %>
            </div>
        <% } else { %>
            <p style="text-align: center; padding: 40px;">Ch∆∞a c√≥ danh m·ª•c. <a href="/admin">ƒêi t·ªõi Admin</a> ƒë·ªÉ th√™m danh m·ª•c.</p>
        <% } %>
    </div>
</section>

<!-- New Products Section -->
<section class="products-section" style="padding: 60px 0; background: #f8f9fa;">
    <div class="container">
        <h2 class="section-title" style="text-align: center; font-size: 32px; margin-bottom: 40px;">S·∫£n Ph·∫©m M·ªõi Nh·∫•t</h2>
        
        <% if (newProducts && newProducts.length > 0) { %>
            <div class="product-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px;">
                <% newProducts.forEach(product => { %>
                    <div class="product-card" style="background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.05); transition: transform 0.3s, box-shadow 0.3s;">
                        <a href="/products/<%= product.slug %>" style="text-decoration: none; color: inherit;">
                            <div style="height: 280px; overflow: hidden; background: #f5f5f5;">
                                <% if (product.primary_image) { %>
                                    <img src="<%= product.primary_image %>" alt="<%= product.name %>" style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s;">
                                <% } else { %>
                                    <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                                        <span style="font-size: 64px;">üëï</span>
                                    </div>
                                <% } %>
                            </div>
                            <div style="padding: 20px;">
                                <h3 style="margin: 0 0 10px 0; font-size: 16px; font-weight: 600; color: #333;"><%= product.name %></h3>
                                <p style="margin: 0; font-size: 20px; font-weight: 700; color: #d32f2f;">
                                    <%= (product.final_price || product.price).toLocaleString('vi-VN') %>ƒë
                                </p>
                            </div>
                        </a>
                    </div>
                <% }) %>
            </div>
            <div style="text-align: center; margin-top: 40px;">
                <a href="/products" class="btn btn-primary" style="padding: 15px 40px;">Xem t·∫•t c·∫£ s·∫£n ph·∫©m</a>
            </div>
        <% } else { %>
            <p style="text-align: center; padding: 40px;">Ch∆∞a c√≥ s·∫£n ph·∫©m. Import seed data ƒë·ªÉ th·∫•y d·ªØ li·ªáu m·∫´u.</p>
        <% } %>
    </div>
</section>

<!-- Best Sellers Section -->
<% if (bestSellers && bestSellers.length > 0) { %>
<section class="products-section" style="padding: 60px 0;">
    <div class="container">
        <h2 class="section-title" style="text-align: center; font-size: 32px; margin-bottom: 40px;">üî• B√°n Ch·∫°y Nh·∫•t</h2>
        
        <div class="product-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px;">
            <% bestSellers.forEach(product => { %>
                <div class="product-card" style="background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <a href="/products/<%= product.slug %>" style="text-decoration: none; color: inherit;">
                        <div style="height: 280px; overflow: hidden; background: #f5f5f5;">
                            <% if (product.primary_image) { %>
                                <img src="<%= product.primary_image %>" alt="<%= product.name %>" style="width: 100%; height: 100%; object-fit: cover;">
                            <% } else { %>
                                <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                                    <span style="font-size: 64px;">üëï</span>
                                </div>
                            <% } %>
                        </div>
                        <div style="padding: 20px;">
                            <h3 style="margin: 0 0 10px 0; font-size: 16px; font-weight: 600; color: #333;"><%= product.name %></h3>
                            <p style="margin: 0; font-size: 20px; font-weight: 700; color: #d32f2f;">
                                <%= (product.final_price || product.price).toLocaleString('vi-VN') %>ƒë
                            </p>
                        </div>
                    </a>
                </div>
            <% }) %>
        </div>
    </div>
</section>
<% } %>

<%- include('../partials/footer') %>
