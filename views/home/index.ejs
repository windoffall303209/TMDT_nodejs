<%- include('../partials/header') %>

<!-- Load Home CSS -->
<link rel="stylesheet" href="/css/home.css">

<!-- Popup Banner Ad (Random - Image Only) -->
<% if (banners && banners.length > 0) { %>
    <% const randomBanner = banners[Math.floor(Math.random() * banners.length)]; %>
    <% if (randomBanner.image_url) { %>
        <div id="popupBanner" class="popup-overlay">
            <div class="popup-content">
                <!-- Close Button -->
                <button onclick="closePopup()" class="popup-close">√ó</button>
                
                <% if (randomBanner.link_url) { %>
                    <a href="<%= randomBanner.link_url %>">
                        <img src="<%= randomBanner.image_url %>" alt="Qu·∫£ng c√°o" class="popup-image">
                    </a>
                <% } else { %>
                    <img src="<%= randomBanner.image_url %>" alt="Qu·∫£ng c√°o" class="popup-image">
                <% } %>
            </div>
        </div>
        <script src="/js/home.js"></script>
    <% } %>
<% } %>

<!-- Hero Intro Section -->
<div class="hero">
    <div class="container hero-content">
        <h1 class="hero-title">üçÇ WIND OF FALL</h1>
        <p class="hero-subtitle">Th·ªùi trang cao c·∫•p d√†nh cho nh·ªØng ai y√™u phong c√°ch</p>
        <p class="hero-desc">Kh√°m ph√° b·ªô s∆∞u t·∫≠p m·ªõi nh·∫•t t·ª´ c√°c th∆∞∆°ng hi·ªáu h√†ng ƒë·∫ßu</p>
        <div class="hero-buttons">
            <a href="/products" class="hero-btn-primary">üõçÔ∏è Mua S·∫Øm Ngay</a>
            <a href="/products/category/nu" class="hero-btn-secondary">üíÉ B·ªô S∆∞u T·∫≠p N·ªØ</a>
        </div>
    </div>
</div>

<!-- Categories Section -->
<section class="home-section">
    <div class="container">
        <h2 class="home-section__title">Danh M·ª•c S·∫£n Ph·∫©m</h2>
        
        <% if (categories && categories.length > 0) { %>
            <div class="home-category-grid">
                <% categories.forEach(category => { %>
                    <a href="/products/category/<%= category.slug %>" style="text-decoration: none;">
                        <div class="home-category-card">
                            <% if (category.image_url) { %>
                                <img src="<%= category.image_url %>" alt="<%= category.name %>">
                            <% } else { %>
                                <div class="home-category-card__placeholder"></div>
                            <% } %>
                            <div class="home-category-card__overlay">
                                <h3 class="home-category-card__title"><%= category.name %></h3>
                                <p class="home-category-card__count"><%= category.product_count || 0 %> s·∫£n ph·∫©m</p>
                            </div>
                        </div>
                    </a>
                <% }) %>
            </div>
        <% } else { %>
            <p class="home-empty-message">Ch∆∞a c√≥ danh m·ª•c. <a href="/admin">ƒêi t·ªõi Admin</a> ƒë·ªÉ th√™m danh m·ª•c.</p>
        <% } %>
    </div>
</section>

<!-- New Products Section -->
<section class="home-section home-section--gray">
    <div class="container">
        <h2 class="home-section__title">S·∫£n Ph·∫©m M·ªõi Nh·∫•t</h2>
        
        <% if (newProducts && newProducts.length > 0) { %>
            <div class="home-product-grid">
                <% newProducts.forEach(product => { %>
                    <div class="home-product-card">
                        <a href="/products/<%= product.slug %>">
                            <div class="home-product-card__image">
                                <% if (product.primary_image) { %>
                                    <img src="<%= product.primary_image %>" alt="<%= product.name %>">
                                <% } else { %>
                                    <div class="home-product-card__placeholder">
                                        <span>üëï</span>
                                    </div>
                                <% } %>
                            </div>
                            <div class="home-product-card__info">
                                <h3 class="home-product-card__name"><%= product.name %></h3>
                                <p class="home-product-card__price">
                                    <%= (product.final_price || product.price).toLocaleString('vi-VN') %>ƒë
                                </p>
                            </div>
                        </a>
                    </div>
                <% }) %>
            </div>
            <div class="home-view-all">
                <a href="/products" class="btn btn-primary" style="padding: 15px 40px;">Xem t·∫•t c·∫£ s·∫£n ph·∫©m</a>
            </div>
        <% } else { %>
            <p class="home-empty-message">Ch∆∞a c√≥ s·∫£n ph·∫©m. Import seed data ƒë·ªÉ th·∫•y d·ªØ li·ªáu m·∫´u.</p>
        <% } %>
    </div>
</section>

<!-- Best Sellers Section -->
<% if (bestSellers && bestSellers.length > 0) { %>
<section class="home-section">
    <div class="container">
        <h2 class="home-section__title">üî• B√°n Ch·∫°y Nh·∫•t</h2>
        
        <div class="home-product-grid">
            <% bestSellers.forEach(product => { %>
                <div class="home-product-card">
                    <a href="/products/<%= product.slug %>">
                        <div class="home-product-card__image">
                            <% if (product.primary_image) { %>
                                <img src="<%= product.primary_image %>" alt="<%= product.name %>">
                            <% } else { %>
                                <div class="home-product-card__placeholder">
                                    <span>üëï</span>
                                </div>
                            <% } %>
                        </div>
                        <div class="home-product-card__info">
                            <h3 class="home-product-card__name"><%= product.name %></h3>
                            <p class="home-product-card__price">
                                <%= (product.final_price || product.price).toLocaleString('vi-VN') %>ƒë
                            </p>
                        </div>
                    </a>
                </div>
            <% }) %>
        </div>
    </div>
</section>
<% } %>

<%- include('../partials/footer') %>
