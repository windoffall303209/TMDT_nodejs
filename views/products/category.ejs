<%- include('../partials/header') %>

<!-- Load Product List CSS -->
<link rel="stylesheet" href="/css/product-list.css">

<div class="products-page">
    <div class="container">
        <h1 class="products-page__title"><%= category ? category.name : 'S·∫£n Ph·∫©m' %></h1>
        
        <div class="products-grid">
            <% if (products && products.length > 0) { %>
                <% products.forEach(product => { %>
                    <div class="product-card">
                        <a href="/products/<%= product.slug || product.id %>">
                            <div class="product-card__image">
                                <% if (product.primary_image) { %>
                                    <img src="<%= product.primary_image %>" 
                                         alt="<%= product.name %>"
                                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                    <div class="product-card__image-fallback">
                                        <span class="product-card__image-icon">üëï</span>
                                    </div>
                                <% } else { %>
                                    <div class="product-card__image-placeholder">
                                        <span class="product-card__image-icon">üëï</span>
                                    </div>
                                <% } %>
                            </div>
                            <div class="product-card__info">
                                <h3 class="product-card__name"><%= product.name %></h3>
                                <% if (product.price !== product.final_price && product.final_price) { %>
                                    <p class="product-card__price-original">
                                        <%= product.price.toLocaleString('vi-VN') %>ƒë
                                    </p>
                                <% } %>
                                <p class="product-card__price">
                                    <%= (product.final_price || product.price).toLocaleString('vi-VN') %>ƒë
                                </p>
                            </div>
                        </a>
                        <div class="product-card__actions">
                            <button onclick="addToCart(<%= product.id %>)" class="product-card__add-btn">
                                üõí Th√™m v√†o gi·ªè h√†ng
                            </button>
                        </div>
                    </div>
                <% }) %>
            <% } else { %>
                <div class="products-empty">
                    <p>Ch∆∞a c√≥ s·∫£n ph·∫©m trong danh m·ª•c n√†y.</p>
                    <a href="/" class="btn btn-primary products-empty__link">V·ªÅ trang ch·ªß</a>
                </div>
            <% } %>
        </div>
    </div>
</div>

<script src="/js/main.js"></script>

<%- include('../partials/footer') %>
